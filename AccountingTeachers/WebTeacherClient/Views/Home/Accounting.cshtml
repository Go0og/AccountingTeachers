@{
    ViewData["Title"] = "Accounting";
}

<div class="text-center">
    <h2 class="display-4">Учетность</h2>
</div>

<div class="filters-container mb-3">
    <div class="row">
        <div class="col-md-2">
            <input type="text" class="form-control filter-input" data-column="0" placeholder="Фильтр по кафедре">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control filter-input" data-column="1" placeholder="Фильтр по ФИО">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control filter-input" data-column="2" placeholder="Фильтр по должности">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control filter-input" data-column="3" placeholder="Фильтр по званию">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control filter-input" data-column="4" placeholder="Фильтр по ставке">
        </div>
        <div class="col-md-2">
            <button id="resetFilters" class="btn btn-secondary">Сбросить фильтры</button>
        </div>
    </div>
</div>

<table id="accountingTable" class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Кафедра</th>
            <th>ФИО</th>
            <th>Должность</th>
            <th>Звание</th>
            <th>Ставка</th>
        </tr>
    </thead>
    <tbody>
        <!-- Данные будут загружены через AJAX -->
    </tbody>
</table>

@section Scripts {
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>

    <script>
        $(document).ready(function() {
            // Инициализация DataTable
            var table = $('#accountingTable').DataTable({
                ajax: {
                    url: '@Url.Action("GetAllAccountingData", "Home")',
                    type: 'GET',
                         dataSrc: function(json) {
            console.log("Полученные данные:", json);
            return json;
        }
                },
                columns: [
                    { data: 'departmentName' },
                    { data: 'fio' },
                    { data: 'position' },
                    { data: 'title' },
                    { data: 'bet' }
                ],
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.11.5/i18n/ru.json'
                }
            });

            // Применение фильтров при вводе текста
            $('.filter-input').on('keyup change', function() {
                var columnIndex = $(this).data('column');
                table.column(columnIndex).search($(this).val()).draw();
            });

            // Сброс всех фильтров
            $('#resetFilters').on('click', function() {
                $('.filter-input').val('');
                table.search('').columns().search('').draw();
            });
        });
    </script>
}